@model IEnumerable<ShoppingCar.Models.Product>
@*@model IPagedList<ShoppingCar.Models.Product>*@
@using ImageResizer;
@using PagedList
@using PagedList.Mvc

@{
    ViewBag.Title = "產品列表";
}
<head>
    <script src="@Url.Content("~/Scripts/jquery-3.3.1.min.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/jquery.blockUI.js")" type="text/javascript"></script>
    
    <link href="~/Content/PagedList.css" rel="stylesheet" />
    @if (TempData["LoginMessage"] != null)
    {
        <script type="text/javascript">
                var message = @Html.Raw(Json.Encode(TempData["LoginMessage"]));
                alert(message);
        </script>
    }
    @if (TempData["LogoutMessage"] != null)
    {
        <script type="text/javascript">
                var message = @Html.Raw(Json.Encode(TempData["LogoutMessage"]));
                alert(message);
        </script>
    }
    @if (TempData["ExcelResultErrorMessage"] != null)
    {
        <script type="text/javascript">
            window.onload = function () {
                alert("@TempData["ExcelResultErrorMessage"]");
            };
        </script>
    }
</head>
<script>
    function Confirm_insert() {
        if (confirm("確定要新增到購物車嗎?")) {
            return true;
        }
        else {
            return false;
        }
    }
    function buttonShow() {
        $("#ImportOrderSubmit").show();
    }
</script>
<h2>產品列表</h2>
<hr />
<div class="row">
    @foreach (var item in ViewBag.PageOfProduct)
    {
        <div class="col-lg-4">
            <div class="thumbnail">
                <!--<img src="@*Url.Content(item.ProductImg)*@" style="width:70%;height:15em" />-->
                @{
                    byte[] img = item.ProductImg_DB;

                    var base64 = Convert.ToBase64String(img);
                    string imageDate = String.Format("data: image / gif;base64,{0}", base64);

                    if (item.ProductImg != null)
                    {
                        <img src="@Url.Content(item.ProductImg)?w=200&h=200&mode=cropyunits " />
                    }
                    else
                    {
                        <img src="~/Image/notImg_.jpg?w=200&h=200&mode=cropyunits" />
                    }
                }
                @*<img src="@Url.Content(item.ProductImg)?w=200&h=200&mode=cropyunits " />*@
                @*<img src="@Url.Content(imageDate)" />*@
                <div class="caption">
                    <h4 class="text-center">@item.ProductName</h4>
                    <h4 class="text-center">NT$@item.ProductPrice</h4>
                    @if (Session["Member"] == null)
                    {
                        <p></p>
                    }
                    else
                    {
                        <p class="text-center">
                            <a href="@Url.Action("AddCar", "Shopping_Car")?ProductID=@item.ProductID" class="btn btn-primary" onclick="return confirm('確定要加入購物車嗎?')">加入購物車</a>
                        </p>
                    }
                </div>
            </div>
        </div>
    }
</div>
@Html.PagedListPager((IPagedList)ViewBag.PageOfProduct, page => Url.Action("Index", new { page }))
